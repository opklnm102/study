




https://github.com/jwilder/nginx-proxy/issues/855

여기 나온 comment에 따르면

로그는 실제로 / dev / stdout에 심볼릭 링크되어 있지만 여전히 블록 장치로 액세스되고 있으므로이 기능은 여전히 ​​제대로 작동 할 것이라고 생각합니다. 실제로 성능 이점이 있는지는 잘 모르겠습니다.

로그 라인은 출력 블록 장치 나 각 요청의 버퍼에 기록됩니다. 블럭 디바이스가 STDOUT이라면 성능 저하가 거의 없습니다.

실제 성능 저하는 Docker가 해당 스트림을 파일에 기록 할 때 발생합니다 (기본 json 파일 드라이버를 사용한다고 가정).

성능 문제가있는 경우 syslog 또는 gelf와 같은 다른 드라이버를 사용하고 로깅 호스트에 로그를 전달하는 것이 좋습니다. 버퍼링 쓰기는 대기 시간이 긴 미디어 (예 : 회전식 하드 드라이브, NFS 등)에서 도움이되지만, 솔직히이 문제가 발생하면 필연적으로 지연됩니다.

@jwilder와 같은 사람들이 이것을 원할 경우 buffer = 4k 및 flush = 2s와 같은 낮은 설정을 사용하여 로그 데이터를 얻기 위해 2 초 이상을 기다릴 필요가 없도록 제안합니다.

개인적으로 STDOUT에서 Docker GELF 드라이버를 통해 Kafka로 데이터를 스트리밍 한 다음 Logstash가 ElasticSearch에 실시간으로 수집하여 Kibana에서 실시간으로 표시합니다. 필자의 경우, 액세스 로그 쓰기에서 Kibana의 실시간 그래프에 나타나는 지연은 1 초보다 훨씬 적으며 Nginx 액세스 로그 버퍼링이 몇 초 이상 걸리면 정말 이상한 "버스트" 낮은 트래픽 사이트에 대한 데이터를 기록하십시오.

=> 위에 내용 중 마지막 문단
docker GELF ----> Kafka -----> Logstash ----> ES -----> Kibana
로 구축되는 log analysis pipeline



